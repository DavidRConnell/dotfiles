# Add ~/bin to path
export PATH=$HOME/bin:$PATH

# Path to your oh-my-zsh installation.
export ZSH="$HOME/.oh-my-zsh"

ZSH_THEME="robbyrussell"
zstyle ':completion:*' menu select

plugins=(
	git
	vi-mode
	colored-man-pages
	osx
)

source $ZSH/oh-my-zsh.sh

# Preferred editor for local and remote sessions
if [[ -n $SSH_CONNECTION ]]; then
	export EDITOR='vim'
else
	export EDITOR='nvim'
fi

unsetopt inc_append_history
unsetopt share_history

# Custom key bindings
bindkey -a k history-beginning-search-backward
bindkey -a j history-beginning-search-forward

# ssh
# export SSH_KEY_PATH="~/.ssh/rsa_id"

function _getdir {
	echo $work/$1
}

function _cddir {
	dpath=$(_getdir $1)
	shift

	if [[ $# -gt 1 ]]; then
		echo 'Only one argument allowed.'
	fi

	cd $dpath/$1 || cd $dpath
}

function cddata {
	_cddir data "$@"
}

function cdprog {
	_cddir programs "$@"
}

function cdcron {
	_cddir cronscripts "$@"
}

function cddoc {
	_cddir docs "$@"
}

function cdpres {
	_cddir presentations "$@"
}

compctl -g "$work/data/"'*'"/(:t)" cddata
compctl -g "$work/programs/"'*'"/(:t)" cdprog
compctl -g "$work/cronscripts/"'*'"/(:t)" cdcron
compctl -g "$work/docs/"'*'"/(:t)" cddoc
compctl -g "$work/presentations/"'*'"/(:t)" cdpres

function duck {
	query=''
	[[ $# -gt 0 ]] && query='?q='
	for key in "$@"; do
		query+="+$key"
	done

	w3m "duckduckgo.com/$query"
}

function matman {
	graphical=false
	[[ $1 =~ '-g' ]] && graphical=true && shift

	address="mathworks.com/help/matlab/ref/$1.html"
	file=$(w3m -dump $address)
	firstline=$(echo $file | grep -n ^$1$ -m1 | grep -o '^[[:digit:]]*')

	if $graphical; then
		((firstline+=23))
		w3m $address +$firstline
	else
		echo $file | tail -n+$firstline | less
	fi
}
